<product-media
  class='product-media-grid {% if media_array.size > 1 %} product-media-grid--{{block_layout}} {% endif %}'
  data-section='{{ sectionId }}'
  id='product-media-{{ product.id }}-{{ sectionId }}'
>
  {%- if product.media != blank -%}
    {%- for media in media_array -%}
      {% liquid
        assign index = forloop.index0
        if featured_media != null
          assign index = forloop.index
        endif
      %}

      <div
        class='shape shape--{{ img_ratio }} product-media-grid__item {% if img_ratio contains 'fit' %} shape--fit {% endif %} {% if enable_content_slide_in %}scroll-trigger animate--slide-in{% endif %}'
        {% if enable_content_slide_in %}
          style='--gsc-animation-order: {{forloop.index}};'
        {% endif %}
        data-media-id='{{ media.id }}'
        {% if media.media_type == 'image' and enable_image_zoom %}
          data-zoom-cursor-target
        {% endif %}
        data-variant='{{ media.alt | strip_html | escape }}'
      >
        {% render 'product-media',
          product: product,
          enable_image_zoom: enable_image_zoom,
          enable_video_autoplay: enable_video_autoplay,
          media: media,
          modal_media_id: media.id,
          enable_video_looping: enable_video_looping,
          enable_video_controls: enable_video_controls,
          sectionId: sectionId,
          class: 'shape__target-image',
          index: index
        %}
      </div>
    {%- endfor -%}
  {%- else -%}
    {%- for media in media_array -%}
      <div
        class='shape shape--{{ img_ratio }} product-media-grid__item {% if img_ratio contains 'fit' %} shape--fit {% endif %} {% if enable_content_slide_in %}scroll-trigger animate--slide-in{% endif %}'
        {% if enable_content_slide_in %}
          style='--gsc-animation-order: {{forloop.index}};'
        {% endif %}
        data-media-id='{{ forloop.index }}'
        {% if enable_image_zoom %}
          data-zoom-cursor-target
        {% endif %}
        data-variant='{{ media.alt | strip_html | escape }}'
      >
        {% render 'product-media',
          product: product,
          enable_image_zoom: enable_image_zoom,
          enable_video_autoplay: enable_video_autoplay,
          media: media,
          modal_media_id: forloop.index,
          enable_video_looping: enable_video_looping,
          enable_video_controls: enable_video_controls,
          sectionId: sectionId,
          class: 'shape__target-image'
        %}
      </div>
    {%- endfor -%}
  {%- endif -%}
</product-media>
